import bpy
import mathutils

path = [
    (-24.40901756286621, 32.55461120605469, 0.03466916084289551),
    (-23.40901756286621, 32.55461120605469, 0.03466916084289551),
    (-22.42098617553711, 32.55461120605469, -0.11958229541778564),
    (-21.42098617553711, 32.55461120605469, -0.11958234012126923),
    (-20.278703689575195, 32.55461120605469, -0.1195823922753334),
    (-19.13642120361328, 32.55461120605469, -0.11958243697881699),
    (-18.14838981628418, 32.55461120605469, 0.034668974578380585),
    (-17.017932891845703, 32.55461120605469, 0.18707427382469177),
    (-15.88450813293457, 32.55461120605469, 0.3190838694572449),
    (-14.749895095825195, 32.55461120605469, 0.4512318968772888),
    (-13.750652313232422, 32.55461120605469, 0.41231921315193176),
    (-12.763368606567383, 32.7088623046875, 0.3738722503185272),
    (-11.811712265014648, 33.013668060302734, 0.3358854651451111),
    (-10.918496131896973, 33.461727142333984, 0.29835331439971924),
    (-10.105133056640625, 34.042301177978516, 0.2612703740596771),
    (-9.391120910644531, 34.74147415161133, 0.22463127970695496),
    (-8.793575286865234, 35.5424919128418, 0.18843066692352295),
    (-8.326820373535156, 36.42615509033203, 0.15266332030296326),
    (-7.793653964996338, 37.435546875, 0.11180688440799713),
    (-7.260486602783203, 38.44493865966797, 0.07095039635896683),
    (-6.72731876373291, 39.45433044433594, 0.03009387105703354),
    (-6.194150447845459, 40.463722229003906, -0.010762680321931839),
    (-5.660982131958008, 41.473114013671875, -0.05161925405263901),
    (-5.127813339233398, 42.482505798339844, -0.09247584640979767),
    (-4.594644546508789, 43.49189758300781, -0.13333244621753693),
    (-4.06147575378418, 44.50128936767578, -0.17418906092643738),
    (-3.5283069610595703, 45.51068115234375, -0.21504569053649902),
    (-2.995138168334961, 46.52007293701172, -0.25590232014656067),
    (-2.4619693756103516, 47.52946472167969, -0.2967589497566223),
    (-1.9288004636764526, 48.538856506347656, -0.33761557936668396),
    (-1.3956314325332642, 49.548248291015625, -0.3784722089767456),
    (-0.8624623417854309, 50.557640075683594, -0.41932883858680725),
    (-0.3292931914329529, 51.56703186035156, -0.4601854681968689),
    (0.20387601852416992, 52.57642364501953, -0.5010421276092529),
    (0.7370452880859375, 53.5858154296875, -0.541898787021637),
    (1.270214557647705, 54.59520721435547, -0.582755446434021),
    (1.8033838272094727, 55.60459899902344, -0.623612105846405),
    (2.128161668777466, 56.54972839355469, -0.6589515805244446),
    (2.499150037765503, 57.62933349609375, -0.6993193030357361),
    (2.870138645172119, 58.70893859863281, -0.7396870255470276),
    (3.2411274909973145, 59.788543701171875, -0.7800547480583191),
    (3.612116575241089, 60.86814880371094, -0.8204224705696106),
    (3.9831058979034424, 61.94775390625, -0.8607901930809021),
    (4.354095458984375, 63.02735900878906, -0.9011579155921936),
    (4.725085258483887, 64.10696411132812, -0.9415256381034851),
    (5.096075057983398, 65.18656921386719, -0.9818933606147766),
    (5.46706485748291, 66.26617431640625, -1.022261142730713),
    (5.838054656982422, 67.34577941894531, -1.062628984451294),
    (6.209044456481934, 68.42538452148438, -1.102996826171875),
    (6.580034255981445, 69.50498962402344, -1.143364667892456),
    (6.951024055480957, 70.5845947265625, -1.183732509613037),
    (7.322013854980469, 71.66419982910156, -1.2241003513336182),
    (7.6930036544799805, 72.74380493164062, -1.2644681930541992),
    (8.063993453979492, 73.82341003417969, -1.3048360347747803),
    (8.434983253479004, 74.90301513671875, -1.3452038764953613),
    (8.805973052978516, 75.98262023925781, -1.3855717182159424),
    (9.176962852478027, 77.06222534179688, -1.4259395599365234),
    (9.547952651977539, 78.14183044433594, -1.4663074016571045),
    (9.91894245147705, 79.221435546875, -1.5066752433776855),
    (10.289932250976562, 80.30104064941406, -1.5470430850982666),
    (10.660922050476074, 81.38064575195312, -1.5874109268188477),
    (11.031911849975586, 82.46025085449219, -1.6277787685394287),
    (11.402901649475098, 83.53985595703125, -1.6681466102600098),
    (11.77389144897461, 84.61946105957031, -1.7085144519805908),
    (12.144881248474121, 85.69906616210938, -1.7488822937011719),
    (12.515871047973633, 86.77867126464844, -1.789250135421753),
    (12.886860847473145, 87.8582763671875, -1.829617977142334),
    (13.257850646972656, 88.93788146972656, -1.869985818862915),
    (13.628840446472168, 90.01748657226562, -1.910353660583496),
    (13.99983024597168, 91.09709167480469, -1.9507215023040771),
    (14.370820045471191, 92.17669677734375, -1.9910893440246582),
    (14.741809844970703, 93.25630187988281, -2.0314571857452393),
    (15.112799644470215, 94.33590698242188, -2.0718250274658203),
    (15.483789443969727, 95.41551208496094, -2.1121928691864014),
    (15.854779243469238, 96.4951171875, -2.1525607109069824),
    (16.22576904296875, 97.57472229003906, -2.1929285526275635),
    (16.596759796142578, 98.65432739257812, -2.2332963943481445),
    (16.771774291992188, 99.63827514648438, -2.2682130336761475),
    (16.971689224243164, 100.76222229003906, -2.3080976009368896),
    (17.17160415649414, 101.88616943359375, -2.347982168197632),
    (17.371519088745117, 103.01011657714844, -2.387866735458374),
    (17.571434020996094, 104.13406372070312, -2.427751302719116),
    (17.77134895324707, 105.25801086425781, -2.4676358699798584),
    (17.971263885498047, 106.3819580078125, -2.5075204372406006),
    (18.171178817749023, 107.50590515136719, -2.5474050045013428),
    (18.37109375, 108.62985229492188, -2.587289571762085),
    (18.571008682250977, 109.75379943847656, -2.627174139022827),
    (18.770923614501953, 110.87774658203125, -2.6670587062835693),
    (18.97083854675293, 112.00169372558594, -2.7069432735443115),
    (19.170753479003906, 113.12564086914062, -2.7468278408050537),
    (19.370668411254883, 114.24958801269531, -2.786712408065796),
    (19.57058334350586, 115.37353515625, -2.826596975326538),
    (19.770498275756836, 116.49748229980469, -2.8664815425872803),
    (19.970413208007812, 117.62142944335938, -2.9063661098480225),
    (20.17032814025879, 118.74537658691406, -2.9462506771087646),
    (20.370243072509766, 119.86932373046875, -2.986135244369507),
    (20.570158004760742, 120.99327087402344, -3.026019811630249),
    (20.77007293701172, 122.11721801757812, -3.065904378890991),
    (20.969987869262695, 123.24116516113281, -3.1057889461517334),
    (21.169902801513672, 124.3651123046875, -3.1456735134124756),
    (21.36981773376465, 125.48905944824219, -3.1855580806732178),
    (21.569732666015625, 126.61300659179688, -3.22544264793396),
    (21.7696475982666, 127.73695373535156, -3.265327215194702),
    (21.969562530517578, 128.86090087890625, -3.3052117824554443),
    (22.169477462768555, 129.98484802246094, -3.3450963497161865),
    (22.36939239501953, 131.10879516601562, -3.3849809169769287),
    (22.390443801879883, 132.10797119140625, -3.4194796085357666),
    (22.41448974609375, 133.24932861328125, -3.4588871002197266),
    (22.438535690307617, 134.39068603515625, -3.4982943534851074),
    (22.462581634521484, 135.53204345703125, -3.537701368331909),
    (22.48662757873535, 136.67340087890625, -3.577108144760132),
    (22.51067352294922, 137.81475830078125, -3.6165146827697754),
    (22.534719467163086, 138.95611572265625, -3.65592098236084),
    (22.558765411376953, 140.09747314453125, -3.695327043533325),
    (22.58281135559082, 141.23883056640625, -3.7347328662872314),
    (22.606857299804688, 142.38018798828125, -3.7741384506225586),
    (22.630903244018555, 143.52154541015625, -3.8135437965393066),
    (22.654949188232422, 144.66290283203125, -3.8529489040374756),
    (22.67899513244629, 145.80426025390625, -3.8923537731170654),
    (22.703041076660156, 146.94561767578125, -3.931758403778076),
    (22.727087020874023, 148.08697509765625, -3.971162796020508),
    (22.75113296508789, 149.22833251953125, -4.010566711425781),
    (22.775178909301758, 150.36968994140625, -4.0499701499938965),
    (22.799224853515625, 151.51104736328125, -4.0893731117248535),
    (22.823270797729492, 152.65240478515625, -4.128775596618652),
    (22.689851760864258, 153.64288330078125, -4.1628570556640625),
    (22.537450790405273, 154.7742919921875, -4.20178747177124),
    (22.385051727294922, 155.90570068359375, -4.24071741104126),
    (22.23265266418457, 157.037109375, -4.279646873474121),
    (22.08025360107422, 158.16851806640625, -4.318575859069824),
    (21.927854537963867, 159.2999267578125, -4.357504844665527),
    (21.775455474853516, 160.43133544921875, -4.3964338302612305),
    (21.623056411743164, 161.562744140625, -4.435362815856934),
    (21.470657348632812, 162.69415283203125, -4.474291801452637),
    (21.31825828552246, 163.8255615234375, -4.51322078704834),
    (21.16585922241211, 164.95697021484375, -4.552149772644043),
    (21.013460159301758, 166.08837890625, -4.591078758239746),
    (20.861061096191406, 167.21978759765625, -4.630007743835449),
    (20.708662033081055, 168.3511962890625, -4.668936729431152),
    (20.423973083496094, 169.30921936035156, -4.702608585357666),
    (20.09877586364746, 170.403564453125, -4.741071701049805),
    (19.77358055114746, 171.49790954589844, -4.779534816741943),
    (19.448387145996094, 172.59225463867188, -4.817997932434082),
    (19.12319564819336, 173.6865997314453, -4.856461048126221),
    (18.798006057739258, 174.78094482421875, -4.894924163818359),
    (18.47281837463379, 175.8752899169922, -4.933387279510498),
    (18.14763069152832, 176.96963500976562, -4.971850395202637),
    (17.82244300842285, 178.06398010253906, -5.010313510894775),
    (17.497255325317383, 179.1583251953125, -5.048776626586914),
    (17.068119049072266, 180.0609588623047, -5.082045555114746),
    (16.577926635742188, 181.09201049804688, -5.1200480461120605),
    (16.087732315063477, 182.12306213378906, -5.158050537109375),
    (15.597536087036133, 183.15411376953125, -5.1960530281066895),
    (15.107338905334473, 184.18516540527344, -5.234055519104004),
    (14.617140769958496, 185.21621704101562, -5.272058010101318),
    (14.190933227539062, 186.1126708984375, -5.150762557983398),
    (13.704082489013672, 187.1366729736328, -5.012208461761475),
    (13.217229843139648, 188.16067504882812, -4.873653888702393),
    (12.730375289916992, 189.18467712402344, -4.735098838806152),
    (12.16995620727539, 190.00416564941406, -4.615253925323486),
    (11.529796600341797, 190.9402618408203, -4.478356838226318),
    (10.889639854431152, 191.87635803222656, -4.341460227966309),
    (10.346364974975586, 192.67079162597656, -4.069910526275635),
    (9.725794792175293, 193.5782470703125, -3.75972580909729),
    (9.10522174835205, 194.48570251464844, -3.4495394229888916),
    (8.441122055053711, 195.1835479736328, -3.181239128112793),
    (7.682532787322998, 195.98068237304688, -2.8747644424438477),
    (6.9146409034729, 196.5638427734375, -2.609675168991089),
    (6.188506126403809, 197.11529541015625, -2.199026584625244),
    (5.35905647277832, 197.74520874023438, -1.7299506664276123),
    (4.692058563232422, 198.2517547607422, -1.1835720539093018),
    (3.939753532409668, 198.62939453125, -0.6437339782714844),
    (3.2708730697631836, 198.9651641845703, 0.01948726177215576),
    (2.540797233581543, 199.1590576171875, 0.6747692227363586),
    (1.7217674255371094, 199.37657165527344, 1.2056894302368164),
    (0.8333878517150879, 199.6125030517578, 1.5995397567749023),
    (-0.0047664642333984375, 199.99468994140625, 1.9886763095855713),
]

def main():
    curve = bpy.data.objects["wire_blue_curve_g"]
    points = curve.data.splines[0].bezier_points
    n_points = len(curve.data.splines[0].bezier_points.values())

    t = len(path)

    frames_per_step = 1

    current_frame = frames_per_step

    for point_index in range(n_points):
        points[point_index].keyframe_insert("co", frame=0)
        points[point_index].keyframe_insert("handle_left", frame=0)
        points[point_index].keyframe_insert("handle_right", frame=0)

    for i in range(t):
        for point_index in range(n_points - 1):
            points[point_index].co.xyz = points[point_index + 1].co.xyz
            points[point_index].handle_left.xyz = points[point_index + 1].handle_left.xyz
            points[point_index].handle_right.xyz = points[point_index + 1].handle_right.xyz
            points[point_index].keyframe_insert("co", frame=current_frame)
            points[point_index].keyframe_insert("handle_left", frame=current_frame)
            points[point_index].keyframe_insert("handle_right", frame=current_frame)
        
        next_point = (mathutils.Vector(path[i]) - curve.location).to_tuple()
        points[n_points - 1].co = next_point
        points[n_points - 1].co.xyz = next_point
        points[n_points - 1].handle_left.xyz = next_point
        points[n_points - 1].handle_right.xyz = next_point
        points[n_points - 1].keyframe_insert("co", frame=current_frame)
        points[n_points - 1].keyframe_insert("handle_left", frame=current_frame)
        points[n_points - 1].keyframe_insert("handle_right", frame=current_frame)
        
        current_frame += frames_per_step
        
if __name__ == '__main__':
    main()
